var TaqeCalculator=angular.module("TaqeCalculator",["ngMaterial","ngAnimate","ngMessages","ngAria","ui.router","calculator.services"]);!function(t){t.config(["$stateProvider","$urlRouterProvider","$compileProvider",function(t,r,e){r.otherwise("/"),t.state("calculator",{url:"/",templateUrl:"partials/calculator-partial.html",controller:"CalculatorController"}).state("history",{url:"/history",templateUrl:"partials/history-partial.html",controller:"HistoryController"}),e.preAssignBindingsEnabled(!0)}])}(TaqeCalculator),angular.module("calculator.services",[]).factory("HistoryRepository",["$window","$filter",function(t,r){var e,l=[],n=function(){if(0==l.length){var e=t.localStorage.getItem("CALC_HISTORY");e&&(l=JSON.parse(e))}l=r("orderBy")(l,"id")};return{setCurrentCalc:function(t){e=t},getCurrentCalc:function(t){return e||(e=this.createCalc()),e},createCalc:function(){return{firstNumber:"",secondNumber:"",operator:"",result:""}},addCalculation:function(r){0==l.length&&n(),r.id=l.length,l.push(r),t.localStorage.setItem("CALC_HISTORY",JSON.stringify(l))},getAll:function(){return n(),l},clearHistory:function(){l=[],t.localStorage.setItem("CALC_HISTORY",JSON.stringify([]))}}}]),function(t){t.controller("CalculatorController",["$scope","$mdDialog","$timeout","HistoryRepository",function(t,r,e,l){function n(){return 1==t.currentCalc.operator.length}function a(){return""==t.currentCalc.firstNumber&&(t.currentCalc.firstNumber="0"),parseInt(t.currentCalc.firstNumber)}function c(){return""==t.currentCalc.secondNumber&&(t.currentCalc.secondNumber=o(t.currentCalc.operator)),parseInt(t.currentCalc.secondNumber)}function o(t){return"*"==t?"1":"0"}function u(t){return t.substring(0,t.length-1)}t.currentCalc=l.getCurrentCalc(),t.shouldShowResult=t.currentCalc.result&&""!=t.currentCalc.result;t.addDigit=function(t){this.shouldShowResult&&this.clearAll(),!n()&&this.currentCalc.firstNumber.length<7?this.currentCalc.firstNumber+=""+t:n()&&this.currentCalc.secondNumber.length<7?this.currentCalc.secondNumber+=""+t:r.show(r.alert().title("Warning").textContent("Each number can have at most 7 digits").ariaLabel("Input validation error").ok("Ok").targetEvent(event))},t.setOperator=function(r){this.shouldShowResult&&this.clearAll(),this.currentCalc.operator=r,""==t.currentCalc.firstNumber&&(t.currentCalc.firstNumber="0")},t.evalOperation=function(){if(!this.shouldShowResult){switch(this.currentCalc.operator){case"*":this.currentCalc.result=a()*c();break;case"+":this.currentCalc.result=a()+c();break;case"-":this.currentCalc.result=a()-c();break;default:this.currentCalc.result=a()}var t=angular.copy(this.currentCalc);l.addCalculation(this.currentCalc),this.shouldShowResult=!0,this.currentCalc=t,l.setCurrentCalc(this.currentCalc)}},t.clearAll=function(){this.currentCalc=l.createCalc(),l.setCurrentCalc(this.currentCalc),this.shouldShowResult=!1},t.erasePrevious=function(){this.shouldShowResult?(this.currentCalc.result="",this.shouldShowResult=!1):this.currentCalc.secondNumber.length>0?this.currentCalc.secondNumber=u(this.currentCalc.secondNumber):this.currentCalc.operator.length>0?this.currentCalc.operator="":this.currentCalc.firstNumber=u(this.currentCalc.firstNumber)}}])}(TaqeCalculator),function(t){t.controller("HistoryController",["$scope","$mdDialog","$location","HistoryRepository",function(t,r,e,l){t.allHistory=l.getAll().reverse(),t.calcList=function(){return this.allHistory},t.setCalculator=function(t){l.setCurrentCalc(angular.copy(t)),e.path("/")},t.clearHistory=function(){r.show(r.confirm().title("Confirmation").textContent("Do you really want to erase all your history?").ariaLabel("Confirmation").ok("Yes").cancel("Cancel").targetEvent(event)).then(function(){l.clearHistory(),e.path("/")},function(){})}}])}(TaqeCalculator);